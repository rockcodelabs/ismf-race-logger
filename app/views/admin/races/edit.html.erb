<div class="space-y-6">
  <!-- Page header with breadcrumb -->
  <div class="space-y-2">
    <nav class="flex text-sm text-gray-500">
      <%= link_to "Competitions", admin_competitions_path, class: "hover:text-ismf-blue" %>
      <span class="mx-2">/</span>
      <%= link_to @competition.name, admin_competition_path(@competition), class: "hover:text-ismf-blue" %>
      <span class="mx-2">/</span>
      <%= link_to "Races", admin_competition_races_path(@competition), class: "hover:text-ismf-blue" %>
      <span class="mx-2">/</span>
      <span class="text-ismf-navy font-medium">Edit Race</span>
    </nav>

    <div>
      <h1 class="text-2xl font-bold text-ismf-navy">Edit Race</h1>
      <p class="mt-1 text-sm text-ismf-gray">
        Update race details for <%= @race.name %>
      </p>
    </div>
  </div>

  <!-- Competition info card -->
  <div class="card bg-gradient-to-r from-ismf-blue to-blue-600 text-white">
    <div class="p-4">
      <div class="flex items-center gap-4">
        <div>
          <div class="text-sm opacity-75">Competition</div>
          <div class="text-lg font-semibold"><%= @competition.name %></div>
        </div>
        <div class="h-10 w-px bg-white/20"></div>
        <div>
          <div class="text-sm opacity-75">Dates</div>
          <div class="text-lg font-semibold"><%= @competition.short_date_range %></div>
        </div>
        <div class="h-10 w-px bg-white/20"></div>
        <div>
          <div class="text-sm opacity-75">Location</div>
          <div class="text-lg font-semibold"><%= @competition.place %></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Current race info -->
  <div class="card border-l-4 border-purple-500">
    <div class="p-4">
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <svg class="h-6 w-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
        </div>
        <div class="ml-3 flex-1">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-medium text-purple-800">Current Race Info</h3>
              <div class="mt-2 text-sm text-purple-700 space-y-1">
                <div><strong>Name:</strong> <%= @race.name %></div>
                <div><strong>Type:</strong> <%= @race.race_type_name %></div>
                <div><strong>Stage:</strong> <%= @race.stage_name %></div>
                <div><strong>Status:</strong> <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-<%= @race.status == 'scheduled' ? 'blue' : @race.status == 'in_progress' ? 'green' : 'gray' %>-100 text-<%= @race.status == 'scheduled' ? 'blue' : @race.status == 'in_progress' ? 'green' : 'gray' %>-800"><%= @race.status.titleize %></span></div>
                <% if @race.scheduled_at.present? %>
                  <div><strong>Scheduled:</strong> <%= @race.formatted_scheduled_datetime %></div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Form card -->
  <div class="card">
    <div class="px-6 py-5 border-b border-gray-200 bg-gray-50">
      <h3 class="text-lg font-medium text-ismf-navy">Race Details</h3>
      <p class="mt-1 text-sm text-ismf-gray">
        Update the race information. Changes to stage type or heat number will regenerate the stage name.
      </p>
    </div>
    <div class="p-6">
      <%= render "form", race: @race %>
    </div>
  </div>

  <!-- Danger zone (delete) -->
  <div class="card border-l-4 border-red-500">
    <div class="p-4">
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <svg class="h-6 w-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
        </div>
        <div class="ml-3 flex-1">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-medium text-red-800">Delete Race</h3>
              <div class="mt-2 text-sm text-red-700">
                <p>Once you delete a race, there is no going back. Please be certain.</p>
              </div>
            </div>
            <%= link_to "Delete Race",
                admin_competition_race_path(@competition, @race),
                data: { 
                  turbo_method: :delete,
                  turbo_confirm: "Are you sure you want to delete '#{@race.name}'? This action cannot be undone." 
                },
                class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500" %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Help card -->
  <div class="card border-l-4 border-blue-500">
    <div class="p-4">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-blue-800">Editing Notes</h3>
          <div class="mt-2 text-sm text-blue-700">
            <ul class="list-disc list-inside space-y-1">
              <li>You can update the name, stage type, heat number, scheduled time, and status</li>
              <li>Completed races cannot be edited (status restriction)</li>
              <li>Position can be adjusted to reorder races within the same race type</li>
              <li>Stage name is automatically regenerated when stage type or heat number changes</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>